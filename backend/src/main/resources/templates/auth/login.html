<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr" th:with="lang=${param.lang} ?: 'fr'">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title th:text="#{login.title}">Connexion</title>

    <!-- Bootstrap local + app -->
    <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="/css/app.css" rel="stylesheet"/>
  </head>
  <body class="d-flex min-vh-100 align-items-center justify-content-center bg-body-tertiary">

    <!-- Carte de connexion -->
    <main class="container" style="max-width:460px;">
      <div class="card shadow-sm">
        <div class="card-body p-4">
          <h1 class="h4 mb-3 text-center" th:text="#{login.title}">Connexion</h1>

          <!-- Messages : erreur / déconnexion -->
          <div th:if="${param.error}" class="alert alert-danger py-2" role="alert" th:text="#{login.error}">
            Identifiants invalides.
          </div>
          <div th:if="${param.logout}" class="alert alert-success py-2" role="alert" th:text="#{login.loggedout}">
            Vous êtes déconnecté(e).
          </div>

          <form method="post" th:action="@{/login}" class="vstack gap-3">
            <div>
              <label for="username" class="form-label" th:text="#{login.username}">Adresse e-mail</label>
              <input id="username" name="username" type="email" autocomplete="username"
                     class="form-control" placeholder="admin@example.com" required/>
            </div>

            <div>
              <label for="password" class="form-label" th:text="#{login.password}">Mot de passe</label>
              <input id="password" name="password" type="password" autocomplete="current-password"
                     class="form-control" required/>
            </div>

            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="remember-me" name="remember-me"/>
              <label class="form-check-label" for="remember-me" th:text="#{login.remember}">Se souvenir de moi</label>
            </div>

            <!-- CSRF -->
            <input type="hidden" th:name="${_csrf?.parameterName}" th:value="${_csrf?.token}"/>

            <button class="btn btn-primary w-100" type="submit" th:text="#{login.submit}">Se connecter</button>
          </form>

          <div class="d-flex justify-content-between align-items-center mt-3">
            <a class="small" th:href="@{/{lang}(lang=${lang})}" th:text="#{back.home}">← Retour à laccueil</a>
            <a class="small text-muted" th:href="@{/{lang}(lang=${lang})}" th:text="#{login.forgot}">Mot de passe oublié ?</a>
          </div>
        </div>
      </div>

      <p class="text-center text-muted small mt-3">
        <span th:text="${#dates.format(#dates.createNow(),'yyyy')}">2025</span> — <span th:text="#{app.title}">GC</span>
      </p>
    </main>

    <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script defer src="/js/app.js"></script>
  </body>
</html>
