<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{_fragments/layout :: layout(~{::body})}">
  <body>
    <div class="d-flex justify-content-between align-items-center mt-4">
      <h1>Clients</h1>
      <form class="d-flex" method="get" role="search">
        <input class="form-control" type="search" name="q" th:value="${q}" placeholder="Rechercher...">
      </form>
    </div>

    <table class="table table-hover align-middle mt-3">
      <thead class="table-light">
        <tr><th>Code</th><th>Nom</th><th>Email</th><th>Pays</th><th class="text-end">Actions</th></tr>
      </thead>
      <tbody>
        <tr th:each="c : ${data.content}" th:id="${'row-' + c.id}">
          <td th:text="${c.code}">CUST-001</td>
          <td th:text="${c.name}">Nom</td>
          <td th:text="${c.email}">email</td>
          <td th:text="${c.country}">CI</td>
          <td class="text-end">
            <form method="post"
                  th:action="@{/{lang}/customers/{id}/delete(id=${c.id}, lang=${#httpServletRequest.getAttribute('lang')?:'fr'})}"
                  hx-target="#row-[[${c.id}]]" hx-swap="outerHTML" hx-post
                  style="display:inline;">
              <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
              <button class="btn btn-sm btn-outline-danger" type="submit">Supprimer</button>
            </form>
          </td>
        </tr>
      </tbody>
    </table>

    <nav th:if="${data.totalPages > 1}">
      <ul class="pagination">
        <li class="page-item" th:classappend="${data.first} ? 'disabled'">
          <a class="page-link" th:href="@{?page=${data.number-1},size=${data.size},q=${q}}">Précédent</a>
        </li>
        <li class="page-item disabled">
          <span class="page-link" th:text="${data.number+1} + ' / ' + ${data.totalPages}">1/1</span>
        </li>
        <li class="page-item" th:classappend="${data.last} ? 'disabled'">
          <a class="page-link" th:href="@{?page=${data.number+1},size=${data.size},q=${q}}">Suivant</a>
        </li>
      </ul>
    </nav>
  </body>
</html>